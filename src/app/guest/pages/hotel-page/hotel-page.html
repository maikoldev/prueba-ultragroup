<div class="container mx-auto px-4 py-8">
  @if (isLoading()) {
    <div class="flex justify-center items-center min-h-screen">
      <div class="loading loading-spinner loading-lg"></div>
    </div>
  } @else if (notFound()) {
    <div class="hero min-h-[80vh] bg-base-200">
      <div class="hero-content text-center">
        <div class="max-w-md">
          <h1 class="text-5xl font-bold mb-4">‚ö†Ô∏è</h1>
          <p class="text-lg mb-4">Hotel no encontrado</p>
          <button (click)="goBack()" class="btn btn-primary">Volver a la b√∫squeda</button>
        </div>
      </div>
    </div>
  } @else if (hotel()) {
    <div class="mb-6">
      <button
        (click)="goBack()"
        class="btn btn-ghost btn-sm gap-2"
        aria-label="Volver a la b√∫squeda"
      >
        ‚Üê Volver a b√∫squeda
      </button>
    </div>

    <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
      <!-- Hotel Images & Info -->
      <div class="lg:col-span-2">
        <!-- Image Gallery -->
        @if (hotel()!.images && hotel()!.images.length > 0) {
          <div class="card bg-base-100 shadow-xl mb-6">
            <figure class="relative bg-gray-200">
              <img
                [src]="hotel()!.images[selectedImageIndex()]"
                [alt]="hotel()!.name"
                class="w-full h-96 object-cover"
              />

              @if (hotel()!.images.length > 1) {
                <button
                  (click)="previousImage()"
                  class="btn btn-circle btn-sm absolute left-4 top-1/2 -translate-y-1/2 bg-black bg-opacity-50 border-none hover:bg-opacity-75"
                  aria-label="Imagen anterior"
                >
                  ‚ùÆ
                </button>
                <button
                  (click)="nextImage()"
                  class="btn btn-circle btn-sm absolute right-4 top-1/2 -translate-y-1/2 bg-black bg-opacity-50 border-none hover:bg-opacity-75"
                  aria-label="Siguiente imagen"
                >
                  ‚ùØ
                </button>

                <div
                  class="absolute bottom-4 left-4 bg-black bg-opacity-50 text-white px-3 py-1 rounded text-sm"
                >
                  {{ selectedImageIndex() + 1 }} / {{ hotel()!.images.length }}
                </div>
              }
            </figure>

            @if (hotel()!.images.length > 1) {
              <div class="px-4 py-2">
                <div class="flex gap-2 overflow-x-auto pb-2">
                  @for (img of hotel()!.images; track $index; let i = $index) {
                    <button
                      (click)="selectImage(i)"
                      [class]="
                        'shrink-0 w-20 h-20 rounded-lg overflow-hidden transition ' +
                        (selectedImageIndex() === i
                          ? 'ring-2 ring-primary'
                          : 'opacity-60 hover:opacity-100')
                      "
                      [attr.aria-label]="'Ver imagen ' + (i + 1)"
                    >
                      <img
                        [src]="img"
                        [alt]="'Imagen ' + (i + 1)"
                        class="w-full h-full object-cover"
                      />
                    </button>
                  }
                </div>
              </div>
            }
          </div>
        }

        <!-- Hotel Info Card -->
        <div class="card bg-base-100 shadow-xl">
          <div class="card-body">
            <h1 class="card-title text-4xl">{{ hotel()!.name }}</h1>

            <div class="flex flex-wrap gap-2 my-4">
              <div class="badge badge-lg gap-1">
                <span class="text-yellow-500">‚òÖ</span>
                {{ hotel()!.rating }}/5
              </div>
              <div class="badge badge-outline">üìç {{ hotel()!.location }}</div>
            </div>

            <p class="text-base-content">{{ hotel()!.description }}</p>

            <div class="divider my-4"></div>

            <div>
              <h3 class="text-lg font-bold mb-3">‚ú® Amenidades</h3>
              <div class="grid grid-cols-2 md:grid-cols-3 gap-2">
                @for (amenity of hotel()!.amenities; track amenity) {
                  <div class="flex items-center bg-gray-100 rounded-lg px-4 py-2">
                    <span>‚úì</span>
                    <span class="ml-2">{{ amenity }}</span>
                  </div>
                }
              </div>
            </div>

          </div>
        </div>

        <!-- Room Availability Section -->
        <div class="divider my-8">Habitaciones Disponibles</div>

        <div class="space-y-6">
          @for (room of hotel()!.rooms; track room.id) {
            <div class="card bg-base-100 shadow-xl border-2 border-base-200">
              <div class="card-body">
                <div class="flex justify-between items-start mb-4">
                  <div>
                    <h3 class="card-title text-2xl">{{ room.name }}</h3>
                    <div class="badge badge-primary mt-2">{{ room.type }}</div>
                  </div>
                  <div class="text-right">
                    <div class="text-sm opacity-70">Desde</div>
                    <div class="text-3xl font-bold text-primary">
                      {{ room.pricePerNight | currency: 'COP' : 'symbol' : '1.0-0' }}
                    </div>
                    <div class="text-xs opacity-70">por noche</div>
                  </div>
                </div>

                <p class="text-base-content mb-4">{{ room.description }}</p>

                <div class="grid grid-cols-2 gap-4 mb-4">
                  <div class="stat bg-base-200 rounded-lg p-4">
                    <div class="stat-title text-xs">Capacidad</div>
                    <div class="stat-value text-lg">{{ room.capacity }}</div>
                    <div class="stat-desc">{{ room.capacity > 1 ? 'personas' : 'persona' }}</div>
                  </div>
                  <div class="stat bg-base-200 rounded-lg p-4">
                    <div class="stat-title text-xs">Tama√±o</div>
                    <div class="stat-value text-lg">{{ room.size }}</div>
                    <div class="stat-desc">metros¬≤</div>
                  </div>
                </div>

                <div class="divider my-2">Amenidades</div>
                <div class="flex flex-wrap gap-2 mb-4">
                  @for (amenity of room.amenities; track amenity) {
                    <div class="badge badge-outline">{{ amenity }}</div>
                  }
                </div>

                <div class="flex items-center justify-between mt-4">
                  <div class="flex items-center gap-2">
                    @if (room.available > 0) {
                      <span class="badge badge-success gap-1">
                        ‚úì Disponible
                      </span>
                      <span class="text-sm opacity-70">{{ room.available }} {{ room.available > 1 ? 'habitaciones' : 'habitaci√≥n' }}</span>
                    } @else {
                      <span class="badge badge-error">‚úó No disponible</span>
                    }
                  </div>

                  <button
                    (click)="onReserve(room.id)"
                    [disabled]="room.available === 0"
                    class="btn btn-primary"
                    [attr.aria-label]="'Reservar ' + room.name"
                  >
                    Reservar
                  </button>
                </div>
              </div>
            </div>
          }
        </div>
      </div>

      <!-- Sidebar - Hotel Summary -->
      <div class="lg:col-span-1">
        <div class="card bg-base-100 shadow-xl sticky top-8">
          <div class="card-body">
            <h2 class="card-title text-2xl">‚ÑπÔ∏è Informaci√≥n</h2>

            <div class="stats shadow-none bg-base-200 flex-col">
              <div class="stat">
                <div class="stat-title text-sm">Categor√≠a</div>
                <div class="stat-value text-lg capitalize">{{ hotel()!.category || 'Est√°ndar' }}</div>
              </div>
              <div class="stat">
                <div class="stat-title text-sm">Tipos de habitaci√≥n</div>
                <div class="stat-value text-lg">{{ hotel()!.rooms.length }}</div>
              </div>
            </div>

            <div class="card-actions flex-col gap-3 mt-6">
              <button
                (click)="goBack()"
                class="btn btn-ghost w-full"
                aria-label="Volver a la b√∫squeda"
              >
                ‚Üê Volver a b√∫squeda
              </button>
            </div>

            <div class="divider my-4"></div>

            <div class="text-sm opacity-70 space-y-2">
              <p>‚úì Cancelaci√≥n gratis hasta 24h antes</p>
              <p>‚úì Mejor precio garantizado</p>
              <p>‚úì Pago seguro</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  } @else {
    <div class="hero min-h-screen bg-base-200">
      <div class="hero-content text-center">
        <div class="max-w-md">
          <h1 class="text-5xl font-bold mb-4">‚ö†Ô∏è</h1>
          <p class="text-lg mb-4">Hotel no encontrado</p>
          <button (click)="goBack()" class="btn btn-primary">Volver a la b√∫squeda</button>
        </div>
      </div>
    </div>
  }
</div>
